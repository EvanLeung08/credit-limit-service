<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.eshare.tunnel.database.ProductLimitTunnel">
  <resultMap id="BaseResultMap" type="com.eshare.tunnel.database.dataobject.ProductLimitDO">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="edit_time" jdbcType="TIMESTAMP" property="editTime" />
    <result column="deleted" jdbcType="TINYINT" property="deleted" />
    <result column="version" jdbcType="BIGINT" property="version" />
    <result column="serial_number" jdbcType="VARCHAR" property="serialNumber" />
    <result column="account_id" jdbcType="BIGINT" property="accountId" />
    <result column="customer_id" jdbcType="BIGINT" property="customerId" />
    <result column="user_id" jdbcType="BIGINT" property="userId" />
    <result column="quota_limit" jdbcType="INTEGER" property="quotaLimit" />
    <result column="quota_balance" jdbcType="INTEGER" property="quotaBalance" />
    <result column="quota_occupancy" jdbcType="INTEGER" property="quotaOccupancy" />
    <result column="quota_frozen" jdbcType="INTEGER" property="quotaFrozen" />
    <result column="quota_base" jdbcType="INTEGER" property="quotaBase" />
    <result column="quota_change" jdbcType="INTEGER" property="quotaChange" />
    <result column="quota_mode" jdbcType="TINYINT" property="quotaMode" />
    <result column="product_code" jdbcType="VARCHAR" property="productCode" />
    <result column="frozen_status" jdbcType="TINYINT" property="frozenStatus" />
    <result column="frozen_time" jdbcType="TIMESTAMP" property="frozenTime" />
    <result column="expire_status" jdbcType="TINYINT" property="expireStatus" />
    <result column="expiration_time" jdbcType="TIMESTAMP" property="expirationTime" />
    <result column="active_status" jdbcType="TINYINT" property="activeStatus" />
    <result column="inactive_time" jdbcType="TIMESTAMP" property="inactiveTime" />
    <result column="abandoned" jdbcType="TINYINT" property="abandoned" />
    <result column="parent_id" jdbcType="BIGINT" property="parentId" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, create_time, edit_time, deleted, version, serial_number, account_id, customer_id,
    user_id, quota_limit, quota_balance, quota_occupancy, quota_frozen, quota_base, quota_change, 
    quota_mode, product_code, frozen_status, frozen_time, expire_status,
    expiration_time, active_status, inactive_time, abandoned, parent_id
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_product_limit
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from t_product_limit
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.eshare.tunnel.database.dataobject.ProductLimitDO">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_product_limit (id, create_time, edit_time, 
      deleted, version, serial_number, 
      account_id, customer_id, user_id,
      quota_limit, quota_balance, quota_occupancy, 
      quota_frozen, quota_base, quota_change, 
      quota_mode, product_code,
      frozen_status, frozen_time, expire_status, 
      expiration_time, active_status, inactive_time, 
      abandoned, parent_id)
    values (#{id,jdbcType=BIGINT}, #{createTime,jdbcType=TIMESTAMP}, #{editTime,jdbcType=TIMESTAMP}, 
      #{deleted,jdbcType=TINYINT}, #{version,jdbcType=BIGINT}, #{serialNumber,jdbcType=VARCHAR}, 
      #{accountId,jdbcType=BIGINT}, #{customerId,jdbcType=BIGINT}, #{userId,jdbcType=BIGINT},
      #{quotaLimit,jdbcType=INTEGER}, #{quotaBalance,jdbcType=INTEGER}, #{quotaOccupancy,jdbcType=INTEGER}, 
      #{quotaFrozen,jdbcType=INTEGER}, #{quotaBase,jdbcType=INTEGER}, #{quotaChange,jdbcType=INTEGER}, 
      #{quotaMode,jdbcType=TINYINT}, #{productCode,jdbcType=VARCHAR},
      #{frozenStatus,jdbcType=TINYINT}, #{frozenTime,jdbcType=TIMESTAMP}, #{expireStatus,jdbcType=TINYINT}, 
      #{expirationTime,jdbcType=TIMESTAMP}, #{activeStatus,jdbcType=TINYINT}, #{inactiveTime,jdbcType=TIMESTAMP}, 
      #{abandoned,jdbcType=TINYINT}, #{parentId,jdbcType=BIGINT})
  </insert>
  <insert id="insertSelective" parameterType="com.eshare.tunnel.database.dataobject.ProductLimitDO">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_product_limit
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
      <if test="editTime != null">
        edit_time,
      </if>
      <if test="deleted != null">
        deleted,
      </if>
      <if test="version != null">
        version,
      </if>
      <if test="serialNumber != null">
        serial_number,
      </if>
      <if test="accountId != null">
        account_id,
      </if>
      <if test="customerId != null">
        customer_id,
      </if>
      <if test="userId != null">
        user_id,
      </if>
      <if test="quotaLimit != null">
        quota_limit,
      </if>
      <if test="quotaBalance != null">
        quota_balance,
      </if>
      <if test="quotaOccupancy != null">
        quota_occupancy,
      </if>
      <if test="quotaFrozen != null">
        quota_frozen,
      </if>
      <if test="quotaBase != null">
        quota_base,
      </if>
      <if test="quotaChange != null">
        quota_change,
      </if>
      <if test="quotaMode != null">
        quota_mode,
      </if>
      <if test="productCode != null">
        product_code,
      </if>
      <if test="frozenStatus != null">
        frozen_status,
      </if>
      <if test="frozenTime != null">
        frozen_time,
      </if>
      <if test="expireStatus != null">
        expire_status,
      </if>
      <if test="expirationTime != null">
        expiration_time,
      </if>
      <if test="activeStatus != null">
        active_status,
      </if>
      <if test="inactiveTime != null">
        inactive_time,
      </if>
      <if test="abandoned != null">
        abandoned,
      </if>
      <if test="parentId != null">
        parent_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=BIGINT},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="editTime != null">
        #{editTime,jdbcType=TIMESTAMP},
      </if>
      <if test="deleted != null">
        #{deleted,jdbcType=TINYINT},
      </if>
      <if test="version != null">
        #{version,jdbcType=BIGINT},
      </if>
      <if test="serialNumber != null">
        #{serialNumber,jdbcType=VARCHAR},
      </if>
      <if test="accountId != null">
        #{accountId,jdbcType=BIGINT},
      </if>
      <if test="customerId != null">
        #{customerId,jdbcType=BIGINT},
      </if>
      <if test="userId != null">
        #{userId,jdbcType=BIGINT},
      </if>
      <if test="quotaLimit != null">
        #{quotaLimit,jdbcType=INTEGER},
      </if>
      <if test="quotaBalance != null">
        #{quotaBalance,jdbcType=INTEGER},
      </if>
      <if test="quotaOccupancy != null">
        #{quotaOccupancy,jdbcType=INTEGER},
      </if>
      <if test="quotaFrozen != null">
        #{quotaFrozen,jdbcType=INTEGER},
      </if>
      <if test="quotaBase != null">
        #{quotaBase,jdbcType=INTEGER},
      </if>
      <if test="quotaChange != null">
        #{quotaChange,jdbcType=INTEGER},
      </if>
      <if test="quotaMode != null">
        #{quotaMode,jdbcType=TINYINT},
      </if>
      <if test="productCode != null">
        #{productCode,jdbcType=VARCHAR},
      </if>
      <if test="frozenStatus != null">
        #{frozenStatus,jdbcType=TINYINT},
      </if>
      <if test="frozenTime != null">
        #{frozenTime,jdbcType=TIMESTAMP},
      </if>
      <if test="expireStatus != null">
        #{expireStatus,jdbcType=TINYINT},
      </if>
      <if test="expirationTime != null">
        #{expirationTime,jdbcType=TIMESTAMP},
      </if>
      <if test="activeStatus != null">
        #{activeStatus,jdbcType=TINYINT},
      </if>
      <if test="inactiveTime != null">
        #{inactiveTime,jdbcType=TIMESTAMP},
      </if>
      <if test="abandoned != null">
        #{abandoned,jdbcType=TINYINT},
      </if>
      <if test="parentId != null">
        #{parentId,jdbcType=BIGINT},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.eshare.tunnel.database.dataobject.ProductLimitDO">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_product_limit
    <set>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="editTime != null">
        edit_time = #{editTime,jdbcType=TIMESTAMP},
      </if>
      <if test="deleted != null">
        deleted = #{deleted,jdbcType=TINYINT},
      </if>
      <if test="version != null">
        version = #{version,jdbcType=BIGINT},
      </if>
      <if test="serialNumber != null">
        serial_number = #{serialNumber,jdbcType=VARCHAR},
      </if>
      <if test="accountId != null">
        account_id = #{accountId,jdbcType=BIGINT},
      </if>
      <if test="customerId != null">
        customer_id = #{customerId,jdbcType=BIGINT},
      </if>
      <if test="userId != null">
        user_id = #{userId,jdbcType=BIGINT},
      </if>
      <if test="quotaLimit != null">
        quota_limit = #{quotaLimit,jdbcType=INTEGER},
      </if>
      <if test="quotaBalance != null">
        quota_balance = #{quotaBalance,jdbcType=INTEGER},
      </if>
      <if test="quotaOccupancy != null">
        quota_occupancy = #{quotaOccupancy,jdbcType=INTEGER},
      </if>
      <if test="quotaFrozen != null">
        quota_frozen = #{quotaFrozen,jdbcType=INTEGER},
      </if>
      <if test="quotaBase != null">
        quota_base = #{quotaBase,jdbcType=INTEGER},
      </if>
      <if test="quotaChange != null">
        quota_change = #{quotaChange,jdbcType=INTEGER},
      </if>
      <if test="quotaMode != null">
        quota_mode = #{quotaMode,jdbcType=TINYINT},
      </if>
      <if test="productCode != null">
        product_code = #{productCode,jdbcType=VARCHAR},
      </if>
      <if test="frozenStatus != null">
        frozen_status = #{frozenStatus,jdbcType=TINYINT},
      </if>
      <if test="frozenTime != null">
        frozen_time = #{frozenTime,jdbcType=TIMESTAMP},
      </if>
      <if test="expireStatus != null">
        expire_status = #{expireStatus,jdbcType=TINYINT},
      </if>
      <if test="expirationTime != null">
        expiration_time = #{expirationTime,jdbcType=TIMESTAMP},
      </if>
      <if test="activeStatus != null">
        active_status = #{activeStatus,jdbcType=TINYINT},
      </if>
      <if test="inactiveTime != null">
        inactive_time = #{inactiveTime,jdbcType=TIMESTAMP},
      </if>
      <if test="abandoned != null">
        abandoned = #{abandoned,jdbcType=TINYINT},
      </if>
      <if test="parentId != null">
        parent_id = #{parentId,jdbcType=BIGINT},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.eshare.tunnel.database.dataobject.ProductLimitDO">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_product_limit
    set create_time = #{createTime,jdbcType=TIMESTAMP},
      edit_time = #{editTime,jdbcType=TIMESTAMP},
      deleted = #{deleted,jdbcType=TINYINT},
      version = #{version,jdbcType=BIGINT},
      serial_number = #{serialNumber,jdbcType=VARCHAR},
      account_id = #{accountId,jdbcType=BIGINT},
      customer_id = #{customerId,jdbcType=BIGINT},
      user_id = #{userId,jdbcType=BIGINT},
      quota_limit = #{quotaLimit,jdbcType=INTEGER},
      quota_balance = #{quotaBalance,jdbcType=INTEGER},
      quota_occupancy = #{quotaOccupancy,jdbcType=INTEGER},
      quota_frozen = #{quotaFrozen,jdbcType=INTEGER},
      quota_base = #{quotaBase,jdbcType=INTEGER},
      quota_change = #{quotaChange,jdbcType=INTEGER},
      quota_mode = #{quotaMode,jdbcType=TINYINT},
      product_code = #{productCode,jdbcType=VARCHAR},
      frozen_status = #{frozenStatus,jdbcType=TINYINT},
      frozen_time = #{frozenTime,jdbcType=TIMESTAMP},
      expire_status = #{expireStatus,jdbcType=TINYINT},
      expiration_time = #{expirationTime,jdbcType=TIMESTAMP},
      active_status = #{activeStatus,jdbcType=TINYINT},
      inactive_time = #{inactiveTime,jdbcType=TIMESTAMP},
      abandoned = #{abandoned,jdbcType=TINYINT},
      parent_id = #{parentId,jdbcType=BIGINT}
    where id = #{id,jdbcType=BIGINT}
  </update>
  <select id="countByModelSelective" parameterType="map" resultType="int">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select count(*)
		from t_product_limit
		<where>
			<include refid="dynamicModelSql" />
		</where>
  </select>
  <select id="deleteByModelSelective" parameterType="map" resultType="int">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    	delete from t_product_limit
		<where>
			<include refid="dynamicModelSql" />
		</where>
  </select>
  <update id="updateByModelSelective" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update t_product_limit
		<set>
			<if test="model.id != null">
				id = #{model.id, jdbcType=BIGINT},
			</if>
			<if test="model.createTime != null">
				create_time = #{model.createTime, jdbcType=TIMESTAMP},
			</if>
			<if test="model.editTime != null">
				edit_time = #{model.editTime, jdbcType=TIMESTAMP},
			</if>
			<if test="model.deleted != null">
				deleted = #{model.deleted, jdbcType=TINYINT},
			</if>
			<if test="model.version != null">
				version = #{model.version, jdbcType=BIGINT},
			</if>
			<if test="model.serialNumber != null">
				serial_number = #{model.serialNumber, jdbcType=VARCHAR},
			</if>
			<if test="model.accountId != null">
				account_id = #{model.accountId, jdbcType=BIGINT},
			</if>
			<if test="model.customerId != null">
				customer_id = #{model.customerId, jdbcType=BIGINT},
			</if>
			<if test="model.userId != null">
				user_id = #{model.userId, jdbcType=BIGINT},
			</if>
			<if test="model.quotaLimit != null">
				quota_limit = #{model.quotaLimit, jdbcType=INTEGER},
			</if>
			<if test="model.quotaBalance != null">
				quota_balance = #{model.quotaBalance, jdbcType=INTEGER},
			</if>
			<if test="model.quotaOccupancy != null">
				quota_occupancy = #{model.quotaOccupancy, jdbcType=INTEGER},
			</if>
			<if test="model.quotaFrozen != null">
				quota_frozen = #{model.quotaFrozen, jdbcType=INTEGER},
			</if>
			<if test="model.quotaBase != null">
				quota_base = #{model.quotaBase, jdbcType=INTEGER},
			</if>
			<if test="model.quotaChange != null">
				quota_change = #{model.quotaChange, jdbcType=INTEGER},
			</if>
			<if test="model.quotaMode != null">
				quota_mode = #{model.quotaMode, jdbcType=TINYINT},
			</if>
			<if test="model.productCode != null">
				product_code = #{model.productCode, jdbcType=VARCHAR},
			</if>
			<if test="model.frozenStatus != null">
				frozen_status = #{model.frozenStatus, jdbcType=TINYINT},
			</if>
			<if test="model.frozenTime != null">
				frozen_time = #{model.frozenTime, jdbcType=TIMESTAMP},
			</if>
			<if test="model.expireStatus != null">
				expire_status = #{model.expireStatus, jdbcType=TINYINT},
			</if>
			<if test="model.expirationTime != null">
				expiration_time = #{model.expirationTime, jdbcType=TIMESTAMP},
			</if>
			<if test="model.activeStatus != null">
				active_status = #{model.activeStatus, jdbcType=TINYINT},
			</if>
			<if test="model.inactiveTime != null">
				inactive_time = #{model.inactiveTime, jdbcType=TIMESTAMP},
			</if>
			<if test="model.abandoned != null">
				abandoned = #{model.abandoned, jdbcType=TINYINT},
			</if>
			<if test="model.parentId != null">
				parent_id = #{model.parentId, jdbcType=BIGINT},
			</if>
		</set>
		<where>
			<include refid="dynamicModelSql" />
		</where>
  </update>
  <sql id="dynamicModelSql">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    	<if test="cond != null">
			<if test="cond.id != null">
				and id = #{cond.id, jdbcType=BIGINT}
			</if>
			<if test="cond.createTime != null">
				and create_time = #{cond.createTime, jdbcType=TIMESTAMP}
			</if>
			<if test="cond.editTime != null">
				and edit_time = #{cond.editTime, jdbcType=TIMESTAMP}
			</if>
			<if test="cond.deleted != null">
				and deleted = #{cond.deleted, jdbcType=TINYINT}
			</if>
			<if test="cond.version != null">
				and version = #{cond.version, jdbcType=BIGINT}
			</if>
			<if test="cond.serialNumber != null and cond.serialNumber != ''">
				and serial_number <if test="!strict"> like '%' ||</if><if test="strict"> = </if>#{cond.serialNumber, jdbcType=VARCHAR}<if test="!strict"> || '%' </if>
			</if>
			<if test="cond.accountId != null">
				and account_id = #{cond.accountId, jdbcType=BIGINT}
			</if>
			<if test="cond.customerId != null">
				and customer_id = #{cond.customerId, jdbcType=BIGINT}
			</if>
			<if test="cond.userId != null">
				and user_id = #{cond.userId, jdbcType=BIGINT}
			</if>
			<if test="cond.quotaLimit != null">
				and quota_limit = #{cond.quotaLimit, jdbcType=INTEGER}
			</if>
			<if test="cond.quotaBalance != null">
				and quota_balance = #{cond.quotaBalance, jdbcType=INTEGER}
			</if>
			<if test="cond.quotaOccupancy != null">
				and quota_occupancy = #{cond.quotaOccupancy, jdbcType=INTEGER}
			</if>
			<if test="cond.quotaFrozen != null">
				and quota_frozen = #{cond.quotaFrozen, jdbcType=INTEGER}
			</if>
			<if test="cond.quotaBase != null">
				and quota_base = #{cond.quotaBase, jdbcType=INTEGER}
			</if>
			<if test="cond.quotaChange != null">
				and quota_change = #{cond.quotaChange, jdbcType=INTEGER}
			</if>
			<if test="cond.quotaMode != null">
				and quota_mode = #{cond.quotaMode, jdbcType=TINYINT}
			</if>
			<if test="cond.productCode != null and cond.productCode != ''">
				and product_code <if test="!strict"> like '%' ||</if><if test="strict"> = </if>#{cond.productCode, jdbcType=VARCHAR}<if test="!strict"> || '%' </if>
			</if>
			<if test="cond.frozenStatus != null">
				and frozen_status = #{cond.frozenStatus, jdbcType=TINYINT}
			</if>
			<if test="cond.frozenTime != null">
				and frozen_time = #{cond.frozenTime, jdbcType=TIMESTAMP}
			</if>
			<if test="cond.expireStatus != null">
				and expire_status = #{cond.expireStatus, jdbcType=TINYINT}
			</if>
			<if test="cond.expirationTime != null">
				and expiration_time = #{cond.expirationTime, jdbcType=TIMESTAMP}
			</if>
			<if test="cond.activeStatus != null">
				and active_status = #{cond.activeStatus, jdbcType=TINYINT}
			</if>
			<if test="cond.inactiveTime != null">
				and inactive_time = #{cond.inactiveTime, jdbcType=TIMESTAMP}
			</if>
			<if test="cond.abandoned != null">
				and abandoned = #{cond.abandoned, jdbcType=TINYINT}
			</if>
			<if test="cond.parentId != null">
				and parent_id = #{cond.parentId, jdbcType=BIGINT}
			</if>
		</if>
  </sql>
  <sql id="Base_Column_List_Prefix">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    my.id,my.create_time,my.edit_time,my.deleted,my.version,my.serial_number,my.account_id,my.customer_id,my.user_id,my.quota_limit,my.quota_balance,my.quota_occupancy,my.quota_frozen,my.quota_base,my.quota_change,my.quota_type,my.quota_mode,my.product_code,my.frozen_status,my.frozen_time,my.expire_status,my.expiration_time,my.active_status,my.inactive_time,my.abandoned,my.parent_id
  </sql>
  <select id="selectByModelSelective" parameterType="map" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select <include refid="Base_Column_List" /> 
		from t_product_limit
		<where>
			<include refid="dynamicModelSql" />
		</where>
  </select>

    <select id="sumQuota" parameterType="long" resultType="int">
        select sum(quota_limit)
        from t_product_limit
        where customer_id = #{customerId, jdbcType=BIGINT}
        and now() &lt; expiration_time and abandoned = 0
    </select>
    <select id="selectByCardIds" parameterType="list" resultMap="BaseResultMap">
        select <include refid="Base_Column_List" />
        from t_product_limit where account_id in
        <foreach close=")" collection="list" item="each" open="(" separator=",">
            #{each}
        </foreach>
    </select>
</mapper>